const path = require('path');
const fs = require('fs');

const desktopFilePath = path.join(__dirname, '..', 'vsls-launcher.desktop');
const desktopFile = fs.readFileSync(desktopFilePath).toString();
const updatedVersion = 'X-Version=' + process.env.npm_package_version;

if (!desktopFile) {
    throw new Error('Failed to read vsls-launcher.desktop');
}

fs.writeFileSync(desktopFilePath, desktopFile.replace(/X-Version=(.*)/,updatedVersion));

console.log('vsls-launcher.desktop X-Version updated to ' + process.env.npm_package_version + '\n');

